---
title: "λ² μ΄μ§€μ• ν†µκ³„ κΈ°λ° κ΄‘κ³  ν¨κ³Ό μΈκ³Όμ¶”λ΅  μ—°κµ¬"
date: 2025-01-10
summary: "Criteo λ°μ΄ν„°μ…‹μ„ ν™μ©ν•μ—¬ κ°μΈν™”λ κ΄‘κ³  ν¨κ³Ό(Uplift)λ¥Ό μ¶”μ •ν•λ” λ² μ΄μ§€μ• μΈκ³Όμ¶”λ΅  λ¨λΈμ„ μ—°κµ¬ν•κ³ , μΌλ°μ μΈ λ¨Έμ‹ λ¬λ‹ λ¨λΈμ νΈν–¥ λ¬Έμ λ¥Ό ν•΄κ²°ν•μ—¬ Bayes Comp 2025 ν•™νμ— λ°ν‘ν• ν”„λ΅μ νΈμ…λ‹λ‹¤."
tags:
  - "sales-marketing"
  - "causal-inference"
  - "bayesian"

links:
- icon: file-pdf
  icon_pack: fas
  name: ν•™ν ν¬μ¤ν„°
  url: 'Bayes_comp2025_poster.pdf'
image:
  preview_only: true
math: true  # π‘ μμ‹ λ λ”λ§ ν™μ„±ν™”!
---

## 1. ν”„λ΅μ νΈ κ°μ”
- **μ£Όμ :** κ΄‘κ³  λ°μ΄ν„°μ κ°μΈλ³„ κ΄‘κ³  ν¨κ³Ό(Uplift), μ¦‰ **CATE(Conditional Average Treatment Effect)** μ¶”μ •
- **λ°μ΄ν„°:** Criteo Incrementality Tests λ°μ΄ν„° (5,000λ… μ‚¬μ©μ, 84% μ²λ¦¬κµ°)
- **λ©ν‘:** λ””μ§€ν„Έ κ΄‘κ³  ν™κ²½μ—μ„ μ •ν™•ν• νƒ€κ² μ„ μ •μ„ ν†µν•΄ ROIλ¥Ό κ·Ήλ€ν™”
- **μ„±κ³Ό:** **Bayes Comp 2025 ν•™ν ν¬μ¤ν„° λ°ν‘**

## 2. ν•µμ‹¬ λ¬Έμ : μ •κ·ν™”λ΅ μΈν• κµλ€ νΈν–¥ (RIC)

### 2-1. κ°•λ ¥ν• κµλ€(Strong Confounding)

Criteo λ°μ΄ν„°μ…‹μ€ κ΄‘κ³  λ…Έμ¶(Exposure)μ΄ μ „ν™ μ„±ν–¥(Conversion Propensity)μ΄ λ†’μ€ μ‚¬μ©μμ—κ² μ§‘μ¤‘λλ” **κ°•λ ¥ν• κµλ€(Strong Confounding)** μ΄ μ΅΄μ¬ν•©λ‹λ‹¤.

<figure style="margin: 2rem 0;">
  <img src="image.png" alt="Propensity Score Distribution" style="width: 75%; border-radius: 8px; display: block; margin: 0 auto;">
  <figcaption style="text-align: center; color: #6b7280; font-size: 0.9rem; margin-top: 0.5rem; font-style: italic;">
    Figure 2. μ²λ¦¬κµ°κ³Ό λ€μ΅°κµ°μ μ„±ν–¥ μ μ(Propensity Score) λ¶„ν¬ 
  </figcaption>
</figure>

### 2-2. Regularization-Induced Confounding (RIC)

- **λ¬Έμ :** CATE μ¶”μ •μ„ μ„ν•΄ μ μ—°ν• λΉ„μ„ ν• λ¨λΈ(e.g., BART, λ¦Ώμ§€ νκ·€)μ„ μ‚¬μ©ν•  κ²½μ°, λ¨λΈμ **μ •κ·ν™”(Regularization) κ³Όμ • μμ²΄κ°€ κµλ€ λ³€μ(X)μ™€ μ²λ¦¬ λ³€μ(Z)μ κ΄€κ³„λ¥Ό μ™κ³΅**μ‹μΌ μ²λ¦¬ ν¨κ³Ό $\tau$μ μ¶”μ •μΉμ— μ‹¬κ°ν• νΈν–¥(Bias)μ„ μ λ°ν•©λ‹λ‹¤.

- **RIC λ©”μ»¤λ‹μ¦:** μ„ ν• λ¦Ώμ§€ νκ·€λ¥Ό μλ΅ λ“¤λ©΄, νΈν–¥μ€ λ‹¤μκ³Ό κ°™μ΄ ν‘ν„λ©λ‹λ‹¤:

$$\text{bias}(\hat{\tau}) = -[(Z'Z)^{-1}Z'X][I + X'(X - \hat{X}_z)^{-1}]\beta$$

μ—¬κΈ°μ„ $\hat{X}_z = Z(Z'Z)^{-1}Z'X$ λ” Zμ— Xλ¥Ό ν¬μν• κ²ƒμ…λ‹λ‹¤.

- **κ²°κ³Ό:** μ •κ·ν™” κ°•λ„κ°€ μ»¤μ§μλ΅ $\hat{\tau}$μ νΈν–¥μ΄ μ¦κ°€ν•λ©°, μ‹ λΆ°κµ¬κ°„μ΄ κ³Όλ„ν•κ² μΆμ•„μ Έ(Under-coverage) 95% μ‹ λΆ°κµ¬κ°„μ΄ μ‹¤μ  μ»¤λ²„λ¦¬μ§€λ” 95% λ―Έλ§μ΄ λ©λ‹λ‹¤.

## 3. ν•΄κ²° λ°©μ•: PS-BART & BCF

λ³Έ μ—°κµ¬μ—μ„λ” RIC νΈν–¥μ„ μ™„ν™”ν•κΈ° μ„ν•΄ BART(Bayesian Additive Regression Trees) λ¨λΈμ„ κΈ°λ°μΌλ΅ ν• λ‘ κ°€μ§€ νΉμν™”λ λ°©λ²•λ΅ μ„ μ μ©ν–μµλ‹λ‹¤.

### 3-1. PS-BART (Propensity-Score BART)

**λ°©λ²•:** μ¶”μ •λ μ„±ν–¥ μ μ $\hat{\pi}(X)$λ¥Ό λ¨λΈμ κ³µλ³€λ‰μΌλ΅ μ§μ ‘ μ¶”κ°€ν•©λ‹λ‹¤.

$$Y \sim f(X, \hat{\pi}(X), Z) + \varepsilon$$

**ν¨κ³Ό:** 
- μ„±ν–¥ μ μλ¥Ό μ΅°κ±΄ν™”ν•¨μΌλ΅μ¨ μ²λ¦¬ λ³€μ(Z)μ™€ κ³µλ³€λ‰(X)μ„ λΉ„μƒκ΄€(decorrelate) μƒνƒλ΅ λ§λ“­λ‹λ‹¤.
- μ„ ν• λ¨λΈμ—μ„ RIC νΈν–¥μ„ μ™„μ „ν μ κ±°ν•λ©°, νΈλ¦¬ κΈ°λ° λ¨λΈμ—μ„λ„ νΈν–¥μ„ ν¬κ² μ¤„μ…λ‹λ‹¤.

### 3-2. BCF (Bayesian Causal Forest)

**λ°©λ²•:** λ¨λΈμ„ μν›„ ν¨κ³Όμ™€ μ²λ¦¬ ν¨κ³Όλ΅ λ…μ‹μ μΌλ΅ λ¶„λ¦¬ν•μ—¬ μ¬-νλΌλ―Έν„°ν™”ν•©λ‹λ‹¤.

$$Y = \mu(X, \hat{\pi}) + Z \cdot \tau(X) + \varepsilon$$

μ—¬κΈ°μ„:
- $\mu(X, \hat{\pi})$: μν›„ ν¨κ³Ό(prognostic surface) - ν†µμ κµ° ν•μ—μ„μ μμƒ κ²°κ³Ό
- $\tau(X)$: μ²λ¦¬ ν¨κ³Ό ν•¨μ(treatment-effect function) - κ³µλ³€λ‰ Xμ— λ”°λ¥Έ μ¦λ¶„ uplift

**ν•µμ‹¬ νΉμ§•:**
- **λ…λ¦½μ  μ‚¬μ „λ¶„ν¬(Independent Priors):** $\mu$μ™€ $\tau$μ— κ°κ° λ‹¤λ¥Έ BART μ‚¬μ „λ¶„ν¬λ¥Ό μ μ©ν•©λ‹λ‹¤.
- **μ„ νƒμ  μ •κ·ν™”:** $\tau(X)$μ—λ§ λ” κ°•ν• μμ¶•(shrinkage) μ μ© (λ” μ μ€ νΈλ¦¬, λ” κΉμ€ ν¨λ„ν‹°)
- **νΈν–¥ μ κ±°:** $\mu$κ°€ μν›„ ν¨κ³Όλ¥Ό λ€λ¶€λ¶„ ν¬μ°©ν•κ² ν•κ³ , $\tau$κ°€ Zμ™€ νΈν–¥λ μƒκ΄€κ΄€κ³„λ¥Ό κ°–λ” κ²ƒμ„ λ°©μ§€ν•μ—¬ RIC νΈν–¥μ„ μ κ±°ν•©λ‹λ‹¤.
- **κ·Ήλ‹¨ μ„±ν–¥ μ μ μ²λ¦¬:** $\hat{\pi}(X)$κ°€ κ·Ήλ‹¨κ°’μΌ λ• μ‚¬μ „λ¶„ν¬κ°€ $\tau \rightarrow 0$μΌλ΅ λ‹Ήκ²¨μ Έ, μ¬λ°”λ¥Έ 95% μ»¤λ²„λ¦¬μ§€λ¥Ό λ³µμ›ν•©λ‹λ‹¤.

## 4. μ‹¤ν— κ²°κ³Ό

### 4-1. μ‹λ®¬λ μ΄μ… μ„±λ¥

μ΄μ§μ μΈ μ²λ¦¬ ν¨κ³Ό(Heterogeneous effect)κ°€ μλ” μ‹λ®¬λ μ΄μ… λ°μ΄ν„°μ—μ„ λ¨λΈ μ„±λ¥μ„ λΉ„κµν–μµλ‹λ‹¤.

**CATE μ¶”μ • μ„±λ¥ (RMSE, Coverage, Credible Interval Length):**

| λ¨λΈ | λ™μ§μ  ν¨κ³Ό ||| μ΄μ§μ  ν¨κ³Ό |||
|------|---------|---------|---------|---------|---------|---------|
| | RMSE | Coverage | Length | RMSE | Coverage | Length |
| **BART** | 1.20 | 0.90 | 4.1 | 1.8 | 0.87 | 5.2 |
| **PS-BART** | 1.00 | 0.96 | 4.3 | 1.7 | 0.91 | 5.4 |
| **BCF** | **0.63** | **0.94** | **2.5** | **1.3** | **0.93** | **4.5** |

**κ²°κ³Ό:** BCFκ°€ λ¨λ“  μ§€ν‘μ—μ„ κ°€μ¥ μ°μν• μ„±λ¥μ„ λ³΄μ€μΌλ©°, νΉν μ΄μ§μ  ν¨κ³Όκ°€ μμ„ λ• RMSEκ°€ ν¬κ² κ°μ„ λμ—μµλ‹λ‹¤.

### 4-2. Criteo λ°μ΄ν„° μ μ©

BCF λ¨λΈμ„ Criteo λ°μ΄ν„°μ— μ μ©ν•μ—¬ κ°μΈλ³„ μ „ν™ Upliftλ¥Ό μ¶”μ •ν–μµλ‹λ‹¤.

**μ£Όμ” λ°κ²¬:**
- **Top 10% νƒ€κ²ν… ν¨κ³Ό:** κ΄‘κ³  ν¨κ³Όκ°€ κ°€μ¥ λ†’μ„ κ²ƒμΌλ΅ μμΈ΅λ **μƒμ„ 10% μ‚¬μ©μμ—κ² νƒ€κ²ν… μ‹, κ΄€μΈ΅λ Upliftκ°€ μ•½ 8.9%**λ΅ λ‚νƒ€λ‚¬μµλ‹λ‹¤.
- **μ „μ²΄ ν‰κ·  λ€λΉ„ 3λ°°:** μ΄λ” **μ „μ²΄ ν‰κ·  Uplift(2.7%)μ 3λ°°κ°€ λ„λ” μμΉ**λ΅, CATE κΈ°λ° μ •λ°€ νƒ€κ²ν…μ μ‹¤μ§μ  ν¨κ³Όλ¥Ό μ…μ¦ν–μµλ‹λ‹¤.
- **μ μ§„μ  κ°μ†:** νƒ€κ²ν… λΉ„μ¨μ΄ μ¦κ°€ν• μλ΅(20-80%) μ¶”κ°€ uplift κΈ°μ—¬λ„κ°€ 2-4% μμ¤€μΌλ΅ μ™„λ§ν•΄μ§‘λ‹λ‹¤.
- **μμΈ΅-μ‹¤μΈ΅ κ²©μ°¨:** λ†’μ€ μ‹­λ¶„μ„μ—μ„ μμΈ΅ upliftμ™€ κ΄€μΈ΅ uplift κ°„μ λμ— λ„λ” μ°¨μ΄λ” λ¨λΈ μΊλ¦¬λΈλ μ΄μ…μ κ°μ„  μ—¬μ§€λ¥Ό μ‹μ‚¬ν•©λ‹λ‹¤.

## 5. κΈ°μ  μ¤νƒ

- **Framework:** R, BART, BCF
- **Causal Inference Methods:** PS-BART, Bayesian Causal Forest
- **Evaluation Metrics:** RMSE, Coverage, Qini Curve, NDCG
- **Data:** Criteo Incrementality Tests (5,000 users, 84% treated)

## 6. κΈ°μ—¬ λ° ν™μ©λ°©μ• 
- **λ°©λ²•λ΅ μ  κΈ°μ—¬:** κ°•ν• κµλ€ ν•μ—μ„ μ •κ·ν™” λ¨λΈμ RIC νΈν–¥μ„ μ μ–΄ν•λ” λ² μ΄μ§€μ• μ ‘κ·Όλ²• μ μ©
- **μ‹¤λ¬΄ μ μ©:** λ””μ§€ν„Έ κ΄‘κ³  ν™κ²½μ—μ„ κ°μΈν™”λ νƒ€κ²ν… μ „λµ μλ¦½ κ°€λ¥
- **ν™•μ¥ κ°€λ¥μ„±:** λ‹¤λ¥Έ λ§μΌ€ν… μΈκ³Όμ¶”λ΅  λ¬Έμ (μ΄λ©”μΌ μΊ νμΈ, ν”„λ΅λ¨μ… μµμ ν™” λ“±)μ—λ„ μ μ© κ°€λ¥


<figure style="margin: 2rem 0;">
  <img src="poster.jpg" alt="Bayes Comp 2025 Poster" style="width: 90%; border-radius: 8px; display: block; margin: 0 auto;">
  <figcaption style="text-align: center; color: #6b7280; font-size: 0.9rem; margin-top: 0.5rem; font-style: italic;">
    Figure 1. Bayes Comp 2025 ν•™ν ν¬μ¤ν„° - λ² μ΄μ§€μ• μΈκ³Όμ¶”λ΅  κΈ°λ° Uplift Modeling
  </figcaption>
</figure>